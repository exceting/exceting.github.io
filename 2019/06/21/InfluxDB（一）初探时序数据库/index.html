<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://myblog.sharemer.com/cicada-avatar_00000.png?imageView2/0/w/32">
  <link rel="icon" type="image/png" sizes="16x16" href="https://myblog.sharemer.com/cicada-avatar_00000.png?imageView2/0/w/16">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","width":300,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="最近公司有个需求需要借助InfluxDB实现（或者更准确的说，使用该数据库可以更容易的实现），因此稍微看了下这个数据库，把比较重要的一些东西先简单记录一下，日后如果踩坑，也会继续在下面补充。  ​">
<meta property="og:type" content="article">
<meta property="og:title" content="InfluxDB（一）初探时序数据库">
<meta property="og:url" content="http://example.com/2019/06/21/InfluxDB%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%9D%E6%8E%A2%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="胖虎de文库">
<meta property="og:description" content="最近公司有个需求需要借助InfluxDB实现（或者更准确的说，使用该数据库可以更容易的实现），因此稍微看了下这个数据库，把比较重要的一些东西先简单记录一下，日后如果踩坑，也会继续在下面补充。  ​">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-1.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-2.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-3.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-4.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-5.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-6.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-7.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-8.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-9.png">
<meta property="og:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-10.png">
<meta property="article:published_time" content="2019-06-21T13:25:00.000Z">
<meta property="article:modified_time" content="2023-12-04T06:33:21.361Z">
<meta property="article:author" content="胖虎">
<meta property="article:tag" content="InfluxDB">
<meta property="article:tag" content="时序数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://myblog.sharemer.com/2019/06/21/20190621-1-1.png">


<link rel="canonical" href="http://example.com/2019/06/21/InfluxDB%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%9D%E6%8E%A2%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2019/06/21/InfluxDB%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%9D%E6%8E%A2%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/","path":"2019/06/21/InfluxDB（一）初探时序数据库/","title":"InfluxDB（一）初探时序数据库"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>InfluxDB（一）初探时序数据库 | 胖虎de文库</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="胖虎de文库" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">胖虎de文库</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">– – – – – _ _ – _ _ –</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">54</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">18</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">60</span></a></li><li class="menu-item menu-item-留言"><a href="/messages/" rel="section"><i class="fa fa-envelope fa-fw"></i>留言</a></li><li class="menu-item menu-item-日常"><a href="/daily/" rel="section"><i class="fa fa-bicycle fa-fw"></i>日常</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9B%B6%E3%80%81%E4%B8%8B%E8%BD%BD-%E5%AE%89%E8%A3%85"><span class="nav-text">零、下载&amp;安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E5%AE%83%E5%8F%AF%E4%BB%A5%E7%94%A8%E6%9D%A5%E5%81%9A%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-text">一、什么是时序数据库，它可以用来做什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81InfluxDB%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-text">二、InfluxDB基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1%EF%BC%9A%E5%BB%BA%E8%A1%A8"><span class="nav-text">2.1：建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8Emysql%E4%B8%AD%E6%A6%82%E5%BF%B5%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB"><span class="nav-text">2.2：基本概念与mysql中概念的对应关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3%EF%BC%9Apoint%E8%AF%A6%E8%A7%A3"><span class="nav-text">2.3：point详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4%EF%BC%9Asql%E8%AF%AD%E5%8F%A5%E7%A4%BA%E8%8C%83"><span class="nav-text">2.4：sql语句示范</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81InfluxDB%E7%9A%84%E6%97%B6%E6%95%88%E8%AE%BE%E7%BD%AE"><span class="nav-text">三、InfluxDB的时效设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81InfluxDB%E7%9A%84%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="nav-text">四、InfluxDB的存储结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1%EF%BC%9A%E7%BB%93%E6%9E%84%E5%B1%82%E7%BA%A7"><span class="nav-text">4.1：结构层级</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2%EF%BC%9ALSM-Tree"><span class="nav-text">4.2：LSM-Tree</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3%EF%BC%9ACache"><span class="nav-text">4.3：Cache</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4%EF%BC%9AWAL"><span class="nav-text">4.4：WAL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5%EF%BC%9ATSM-File"><span class="nav-text">4.5：TSM File</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-6%EF%BC%9ACompactor"><span class="nav-text">4.6：Compactor</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E5%85%B7%E4%BD%93%E6%A1%88%E4%BE%8B%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%AE%9E%E9%99%85%E7%9A%84%E5%AD%98%E5%82%A8%E7%9B%AE%E5%BD%95"><span class="nav-text">五、具体案例，以及实际的存储目录</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1%EF%BC%9AInfluxDB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">5.1：InfluxDB配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2%EF%BC%9A%E5%85%B7%E4%BD%93%E7%9A%84%E6%95%B0%E6%8D%AE%E7%9B%AE%E5%BD%95"><span class="nav-text">5.2：具体的数据目录</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="nav-text">六、执行计划</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-text">七、总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="胖虎"
      src="https://myblog.sharemer.com/cicada-avatar_00000.png">
  <p class="site-author-name" itemprop="name">胖虎</p>
  <div class="site-description" itemprop="description">Stay young, stay simple.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/exceting" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;exceting" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1807301715@qq.com" title="E-Mail → mailto:1807301715@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/22022137/butter-b" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;22022137&#x2F;butter-b" rel="noopener me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/06/21/InfluxDB%EF%BC%88%E4%B8%80%EF%BC%89%E5%88%9D%E6%8E%A2%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://myblog.sharemer.com/cicada-avatar_00000.png">
      <meta itemprop="name" content="胖虎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="胖虎de文库">
      <meta itemprop="description" content="Stay young, stay simple.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="InfluxDB（一）初探时序数据库 | 胖虎de文库">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          InfluxDB（一）初探时序数据库
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-06-21 21:25:00" itemprop="dateCreated datePublished" datetime="2019-06-21T21:25:00+08:00">2019-06-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">时序数据库</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>16 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><blockquote>
<p>最近公司有个需求需要借助<code>InfluxDB</code>实现（或者更准确的说，使用该数据库可以更容易的实现），因此稍微看了下这个数据库，把比较重要的一些东西先简单记录一下，日后如果踩坑，也会继续在下面补充。</p>
</blockquote>
<p>​	<span id="more"></span></p>
<h3 id="零、下载-安装"><a href="#零、下载-安装" class="headerlink" title="零、下载&amp;安装"></a>零、下载&amp;安装</h3><p>官方地址：<a target="_blank" rel="noopener" href="https://portal.influxdata.com/downloads/">https://portal.influxdata.com/downloads/</a></p>
<h3 id="一、什么是时序数据库，它可以用来做什么？"><a href="#一、什么是时序数据库，它可以用来做什么？" class="headerlink" title="一、什么是时序数据库，它可以用来做什么？"></a>一、什么是时序数据库，它可以用来做什么？</h3><p>简单来说<code>时序数据库</code>就是存储带有<code>时间戳</code>且包含<code>随时间发生变化</code>的数据，<code>InfluxDB</code>属于一种<code>时序数据库</code>。这类数据具体指什么数据呢？这里举几个例子：</p>
<ol>
<li>监控，比如某一时段CPU占用率、服务QPS、服务耗时等监控数据</li>
<li>某飞机在运行过程中各时刻的高度、速度、机舱内温度、湿度</li>
<li>某地区每时每刻的室外温度记录</li>
</ol>
<p>上述的数据都满足某一个具体的事物（监控指标、飞机、地区）随着时间的变化而需要记录的一些数据（监控数据、速度、温度等），这些数据被称为时序性数据，这些数据可以被用来做大数据分析、人工智能等。</p>
<blockquote>
<p><strong>Q：</strong>通过上述的例子，这些无非是一些指标数据嘛，为什么非得用时序性数据库记录？不可以用<code>Mysql</code>这种关系型数据库来做吗？</p>
<p><strong>A：</strong>不可以，首先对于这种数据，量级上是巨大的，比如每时每刻都要记录某飞机的坐标变化，类似这种指标，量级很庞大，关系型数据库设计之初并不是为了处理这种大数据量级的，即便是后来的分表分库，也是为了优化数据量和访问量大了以后查询和写入性能问题的，所以不适合用来存储数量如此庞大的数据，所以这并不是能不能实现的问题，而是适不适合的问题，而时序型数据库的写入速度非常快，其次内部还会对存储数据进行压缩，同时提供了更高的可用性，比如数据保留策略、数据聚合函数、连续查询等。数据保留策略可以保证超过指定期限的数据被回收，释放磁盘空间。</p>
</blockquote>
<h3 id="二、InfluxDB基本概念"><a href="#二、InfluxDB基本概念" class="headerlink" title="二、InfluxDB基本概念"></a>二、InfluxDB基本概念</h3><h4 id="2-1：建表"><a href="#2-1：建表" class="headerlink" title="2.1：建表"></a>2.1：建表</h4><p>不需要专门建表，一般<code>insert</code>执行过去时，如果发现表不存在，就自动创建。</p>
<h4 id="2-2：基本概念与mysql中概念的对应关系"><a href="#2-2：基本概念与mysql中概念的对应关系" class="headerlink" title="2.2：基本概念与mysql中概念的对应关系"></a>2.2：基本概念与mysql中概念的对应关系</h4><table>
<thead>
<tr>
<th align="left">概念名称</th>
<th align="left">概念解释</th>
<th align="left">MySQL类比</th>
</tr>
</thead>
<tbody><tr>
<td align="left">database</td>
<td align="left">数据库</td>
<td align="left">类似mysql里的库</td>
</tr>
<tr>
<td align="left">measurement</td>
<td align="left">表</td>
<td align="left">类似mysql里的表</td>
</tr>
<tr>
<td align="left">point</td>
<td align="left">一行数据记录</td>
<td align="left">类似mysql里的一行数据</td>
</tr>
</tbody></table>
<center>表1</center>

<h4 id="2-3：point详解"><a href="#2-3：point详解" class="headerlink" title="2.3：point详解"></a>2.3：point详解</h4><p><code>point</code>的概念就类似于<code>mysql</code>里<code>一行数据</code>（data point，直译为数据点，可以理解成一行数据），<code>point</code>的构成部分有三个：</p>
<table>
<thead>
<tr>
<th align="left">point属性</th>
<th align="left">属性解释</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">time</td>
<td align="left">时间戳</td>
<td align="left">influxdb自带字段，单位：纳秒</td>
</tr>
<tr>
<td align="left">tags</td>
<td align="left">有各种索引的属性</td>
<td align="left">可设置多个，逗号隔开</td>
</tr>
<tr>
<td align="left">fields</td>
<td align="left">没有索引的属性</td>
<td align="left">可设置多个，逗号隔开</td>
</tr>
</tbody></table>
<center>表2</center>

<p><code>tags</code>和<code>fileds</code>的区别：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> field无索引，一般表示会随着时间戳而发生改变的属性，比如温度、经纬度等，类型可以是 string, <span class="type">float</span>, <span class="type">int</span>, bool</span><br><span class="line"><span class="number">2.</span> tag有索引，一般表示不会随着时间戳而发生改变的属性，比如城市、编号等，类型只可为 string</span><br></pre></td></tr></table></figure>

<p>比较值得注意的是：在<code>InfluxDB</code>中，<code>tags</code>决定了<code>series</code>的数量，而<code>series</code>的数量越大，对于系统CPU和<code>InfluxDB</code>的性能影响越大，<code>series</code>估算方法下面会说。</p>
<h4 id="2-4：sql语句示范"><a href="#2-4：sql语句示范" class="headerlink" title="2.4：sql语句示范"></a>2.4：sql语句示范</h4><p><strong>建库：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database &quot;库名&quot;</span><br></pre></td></tr></table></figure>

<p>一般来说，新建完库，还要对该库设置自己的<code>时效策略</code>（<code>RP</code>），下面会详细说明<code>RP</code>的设置方法，一般建好库后都会有一个默认的<code>RP策略</code></p>
<p><strong>插入数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> results,hostname<span class="operator">=</span>index2,name<span class="operator">=</span>index2333  <span class="keyword">value</span><span class="operator">=</span><span class="number">2</span>,value2<span class="operator">=</span><span class="number">4</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">-------- ----------------------------  -------------------------</span></span><br><span class="line"></span><br><span class="line">        表名               tags的设置                fields的设置</span><br></pre></td></tr></table></figure>

<p>上面这句sql的意思就是说在名为<code>result</code>的表里，插入两个分别命名为<code>hostname</code>和<code>name</code>取值分别为<code>index2</code>和<code>index2333</code>的<code>tags</code>，以及两个分别命名为<code>value</code>和<code>value2</code>取值分别为2和4的<code>fields</code>的数据。</p>
<blockquote>
<p>⚠️ 注意：这里的指令直接输入整数，<code>InfluxDB</code>是按照<code>浮点型</code>处理的，如果一定要让上面的<strong>value&#x3D;2</strong>和<strong>value2&#x3D;4</strong>中的<strong>2</strong>和<strong>4</strong>是整型数据，那么需要在后面加上修饰词：<strong>value&#x3D;2i</strong>，<strong>i</strong>就代表整型。</p>
</blockquote>
<p><strong>检索数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> results</span><br></pre></td></tr></table></figure>

<p>打印结果为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name: results2</span><br><span class="line">time                hostname name      value value2</span><br><span class="line">----                -------- ----      ----- ------</span><br><span class="line">1560928150794920700 index2   index2333 2     4</span><br></pre></td></tr></table></figure>

<p><strong>分页检索：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表 <span class="keyword">WHERE</span> 条件 LIMIT <span class="keyword">rows</span> <span class="keyword">OFFSET</span> (page <span class="operator">-</span> <span class="number">1</span>)<span class="operator">*</span><span class="keyword">rows</span></span><br></pre></td></tr></table></figure>

<p>rows代表每页展示行数，page表示页码</p>
<p><strong>删除表：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> measurement &quot;表名&quot;</span><br></pre></td></tr></table></figure>

<h3 id="三、InfluxDB的时效设置"><a href="#三、InfluxDB的时效设置" class="headerlink" title="三、InfluxDB的时效设置"></a>三、InfluxDB的时效设置</h3><p>很遗憾，<code>InfluxDB</code>是不支持删除和修改的，删除有专门的操作，但是性能很低，不建议使用。</p>
<p><code>InfluxDB</code>支持定期清除数据策略。</p>
<p>查看当前库对应策略配置的命令为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> retention policies <span class="keyword">on</span> &quot;库名&quot;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name       duration      shardGroupDuration       replicaN     default</span><br><span class="line">-------    ---------     ------------------       ---------    -------</span><br><span class="line">autogen        0s            168h0m0s                 1         true</span><br></pre></td></tr></table></figure>

<p><code>name</code>：过期策略名</p>
<p><code>duration</code>：保留多长时间的数据，比如3w，意思就是把三周前的数据清除掉，只保留三周内的，支持h（小时），d（天），w（星期）这几种配法。</p>
<p><code>shardGroupDuration</code>：存储数据的分组结构，比如设置为1d，表示的是每组存储1d的数据量，也就是说数据将按照天为单位划分存储分组，然后根据每条数据的时间戳决定把它放到哪个分组里，因此这个概念还会影响到过期策略，因为InfluxDB在清除过期数据时不可能逐条清理，而是通过清除整个<code>ShardGroup</code>的方式进行，因为通过跟当前时间对比就可以知道哪些分组里的数据一定是过期的，从而进行整组清理，效率往往更高。</p>
<p><code>replicaN</code>：副本数量，一般为1个（这个大概就是备份的意思？这个配置在单实例模式下不起作用）</p>
<p><code>default</code>：是否是默认配置，设置为<code>true</code>表示默认的意思，主要用于查询时是否指定策略，如果不指定，则这个查询就是针对<code>default=true</code>的策略进行的，注意，本文章里的sql都没有指明保留策略的名字，如果有需要，那么请指定。一个库允许有多套策略配置（每套策略里都可以有自己的一份数据，比如同样一张表的数据在策略A和策略B的情况下是不同的，可以理解为一个库对应N个策略，每个策略里有自己的N多张表，相互独立），在不指定策略名称的情况下写的sql，默认使用<code>default=true</code>的策略。</p>
<p>当然，策略也支持修改，指令如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> retention policy &quot;autogen&quot; <span class="keyword">on</span> &quot;test&quot; duration <span class="number">30</span>d <span class="keyword">default</span></span><br></pre></td></tr></table></figure>

<p>上面这条指令就会把上面策略明为<code>autogen</code>的策略有效保存时间改为<code>30天</code>。</p>
<h3 id="四、InfluxDB的存储结构"><a href="#四、InfluxDB的存储结构" class="headerlink" title="四、InfluxDB的存储结构"></a>四、InfluxDB的存储结构</h3><h4 id="4-1：结构层级"><a href="#4-1：结构层级" class="headerlink" title="4.1：结构层级"></a>4.1：结构层级</h4><p>了解完策略，结合上面提到的<code>series</code>、<code>tags</code>、<code>fields</code>等概念，画一下单个<code>InfluxDB库</code>的存储结构：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-1.png" alt="图1"></p>
<p>图里没有体现出<code>tags</code>、<code>fields</code>这些数据层面的东西，它们最终被存放在了<code>Shard</code>里，之前说过<code>tags</code>会影响<code>series</code>的大小，其实<code>series</code>就相当于一个唯一化分类，<code>eries</code>估算方式为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series的个数 = RP × measurement × tags（tags去重后的个数）</span><br></pre></td></tr></table></figure>

<p>比如一个<code>database</code>中有一个<code>measurement</code>，叫<code>test</code>，有<code>两个RP</code>（7d, 30d），<code>tag</code>有<code>host</code>，<code>server</code>。host的值有<code>hostA、hostB</code>，server为<code>server1，server2</code>。那么这个database的series值为<code>2RP x 4tags = 8</code></p>
<h4 id="4-2：LSM-Tree"><a href="#4-2：LSM-Tree" class="headerlink" title="4.2：LSM-Tree"></a>4.2：LSM-Tree</h4><p>回归<code>图1</code>前，先来了解下<code>LSM-Tree</code>，几乎所有的k-v存储的写密集型数据库都采用该数据结构实现，该数据结构的结构如下（注意下面说的层级并非树的层级，而是合并逻辑发生时的层级）：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-2.png" alt="图2"></p>
<p>如<code>图2</code>，该结构写入流程如下：</p>
<p>写入的数据首先加到0层，0层的数据存储在内存中，短期内查询的数据一般在0层，由于是内存操作，因此效率会非常高，当0层的数据达到一定大小时，此时会把0层 和位于它下面的1层进行合并，然后合并出来的新的数据（0层+1层的数据）会顺序写磁盘（这里由于是顺序写入磁盘，因此写性能会非常好），然后替换掉原来老的1层数据，当1层达到一定大小的时候，将继续和它的下层合并，以此类推，一级一级的往下递，除此之外还可以将合并之后旧文件全部删掉，留下最新的。</p>
<p><code>LSM-Tree</code>参考文章：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/news/340271">LSM-tree 基本原理及应用</a></p>
<p>然后回归<code>图1</code>，最终的数据会被存储进<code>Shard</code>，<code>Shard</code>里存在几个区域，就是最终存放数据的地方，下面针对这几个区域说明下它们的作用：</p>
<h4 id="4-3：Cache"><a href="#4-3：Cache" class="headerlink" title="4.3：Cache"></a>4.3：Cache</h4><p>相当于上面说的<code>LSM-Tree</code>的<code>0层</code>，存放于<code>内存</code>中，写入的数据时首先被该模块接收并存储，该模块在内存中表现为一个map结构，k &#x3D; seriesKey + 分隔符 + fieldsName，v &#x3D; 具体的filed对应的值的数组，具体结构体如下（参考网上资料）：</p>
<figure class="highlight c"><figcaption><span>代码块1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">type Cache <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    commit  sync.Mutex</span><br><span class="line">    mu      sync.RWMutex</span><br><span class="line">    store   <span class="built_in">map</span>[<span class="built_in">string</span>]*entry</span><br><span class="line">    size    uint64              <span class="comment">// 当前使用内存的大小</span></span><br><span class="line">    maxSize uint64              <span class="comment">// 缓存最大值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// snapshots are the cache objects that are currently being written to tsm files</span></span><br><span class="line">    <span class="comment">// they&#x27;re kept in memory while flushing so they can be queried along with the cache.</span></span><br><span class="line">    <span class="comment">// they are read only and should never be modified</span></span><br><span class="line">    <span class="comment">// memtable 快照，用于写入 tsm 文件，只读</span></span><br><span class="line">    snapshot     *Cache</span><br><span class="line">    snapshotSize uint64</span><br><span class="line">    snapshotting <span class="type">bool</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// This number is the number of pending or failed WriteSnaphot attempts since the last successful one.</span></span><br><span class="line">    snapshotAttempts <span class="type">int</span></span><br><span class="line"></span><br><span class="line">    stats        *CacheStatistics</span><br><span class="line">    lastSnapshot time.Time</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基于前面说的<code>LSM-Tree</code>，可以知道这里的cache不是持续增长的，而是达到一定值就会进行跟下层存储在磁盘上的数据（1~n层）进行合并，然后清空cache，在InfluxDB中，这一部分存储在磁盘上的数据，就是指<code>TSM File模块</code>，下面会介绍。</p>
<h4 id="4-4：WAL"><a href="#4-4：WAL" class="headerlink" title="4.4：WAL"></a>4.4：WAL</h4><p>在上面对于Cache的描述中，Cache是基于内存做的写入数据接收方，那么如果中途机器宕掉，那么就会造成Cache里数据丢失的问题，为了解决这个问题，InfluxDB就设计了<code>WAL模块</code>，实际在写入一个数据时，不仅会先写进Cache，还会<code>写入WAL</code>，可以简单理解WAL就是对Cache里数据的<code>备份</code>，防止数据丢失，在Cache做完一次合并清除掉自身时，旧的WAL文件也会随之删除，然后新建一个WAL，迎接新一轮的写入。同样的，在InfluxDB启动时，也会先去<code>读取WAL文件初始化Cache模块</code>。</p>
<h4 id="4-5：TSM-File"><a href="#4-5：TSM-File" class="headerlink" title="4.5：TSM File"></a>4.5：TSM File</h4><p>用于组成<code>TSM-Tree</code>结构的主要磁盘文件（可以对应<code>图2</code>的1~n层），内部做了很多存储以及压缩优化，单个<code>TSM File</code>的最大大小为<code>2GB</code>。</p>
<h4 id="4-6：Compactor"><a href="#4-6：Compactor" class="headerlink" title="4.6：Compactor"></a>4.6：Compactor</h4><p>在后台持续运行的一个task（频率为1s），主要做以下事情：</p>
<ol>
<li>在Cache达到阈值时，进行快照，然后将数据合并并保存在TSM File中</li>
<li>合并<code>TSM File</code>，将多个小型TSM File进行合并，使得每个文件的大小尽可能达到单个文件最大大小（也就是上面说到的2GB）</li>
<li>检查并<code>删除</code>一些<code>已关闭</code>的WAL文件</li>
</ol>
<h3 id="五、具体案例，以及实际的存储目录"><a href="#五、具体案例，以及实际的存储目录" class="headerlink" title="五、具体案例，以及实际的存储目录"></a>五、具体案例，以及实际的存储目录</h3><p>结合<code>图1</code>的结构以及<code>图2</code>的数据结构，再加上对<code>shard</code>内部各组件的介绍，下面通过一个实际的例子来探索下InfluxDB实际的存储目录。</p>
<p>现在创建出来一个叫<code>style_rank</code>的库，且设置<code>默认RP为7d</code>，保存周期为<code>7天</code>，默认分组策略为<code>24h</code>分一次，如图：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-3.png" alt="图3"></p>
<p>图中名为<code>7d</code>的<code>rp策略</code>被设置为默认策略，其中<code>duration</code>被设置为<code>168h</code>，<code>shardGroupDuration</code>被设置为了<code>24h</code>，意味着该策略里的表数据将以7天为一个周期过期，期间以1天为单位分组。</p>
<h4 id="5-1：InfluxDB配置文件"><a href="#5-1：InfluxDB配置文件" class="headerlink" title="5.1：InfluxDB配置文件"></a>5.1：InfluxDB配置文件</h4><p>下载下来一个InfluxDB后，通过配置文件<code>influxdb.conf</code>可以配置各个文件存放的目录：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-4.png" alt="图4"></p>
<p>这几个配置决定了你将产生的数据存放在哪里，建议自定义这个，默认的目录很迷&#x3D;_&#x3D;</p>
<h4 id="5-2：具体的数据目录"><a href="#5-2：具体的数据目录" class="headerlink" title="5.2：具体的数据目录"></a>5.2：具体的数据目录</h4><p>配置完上面的文件，启动，然后录入数据，然后再去具体的目录下查找具体的数据文件：</p>
<p><strong>元数据层：</strong>用来存放<code>当前库的属性</code>，比如<code>RP</code>、<code>默认RP</code>、<code>分组策略</code>等。</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-5.png" alt="图5"></p>
<p><strong>wal层：</strong>用来存放刚写入数据的信息，会先写入内存，然后异步写入<code>wal文件</code>，wal文件用来重启InfluxDB时恢复内存数据用，当wal文件达到一定大小时，会压入<code>data层</code>，<code>wal层</code>的结构和<code>data层</code>的<code>几乎一致</code>：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-6.png" alt="图6"></p>
<p>上面进入wal目录后，需要选择正确的库，这里选择<code>style_rank</code>，进入库后，会显示出该库的所有RP，这里选择<code>7d</code>，然后对应<code>图1</code>，你现在来到了<code>ShardGrou</code>p层，<code>图6</code>中的编号，就是生成的<code>ShardGroup</code>，随便进入一个，则可以看到最终的<code>wal文件</code>（事实上只有当天建的group内的wal才有数据）。</p>
<p><strong>data层：</strong>用来最终存放数据的目录，所有<code>wal文件</code>内的数据达到一定大小后，均会被压缩进<code>data层</code>，现在进入<code>data层</code>，然后进入<code>style_rank</code>：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-7.png" alt="图7"></p>
<p>可以看到下方除了有两个<code>RP策略</code>外，还有<code>_series目录</code>，这个目录就是存放<code>索引</code>（<code>tags</code>字段所产生的索引数据）的地方，用于服务重启时恢复索引数据用。</p>
<p>进入<code>7d</code>，可以看到跟wal层差不多的<code>ShardGroup</code>分层，你现在又来到了<code>图1</code>的<code>ShardGroup</code>层：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-8.png" alt="图8"></p>
<p>然后再次进入一个分组内：</p>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-9.png" alt="图9"></p>
<p>最终的<code>tsm文件</code>就存在该目录下，<code>fields.idx</code>存放的是表里的<code>fields元数据</code>，用于写入数据时做<code>效验</code>用。</p>
<h3 id="六、执行计划"><a href="#六、执行计划" class="headerlink" title="六、执行计划"></a>六、执行计划</h3><p>然后继续由上面的<code>style_rank</code>库，在<code>7d</code>这个<code>RP</code>下，新建两张表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> season_views,<span class="type">date</span><span class="operator">=</span>&quot;201907&quot; season_id<span class="operator">=</span><span class="number">666</span>,views<span class="operator">=</span><span class="number">56789</span></span><br><span class="line"><span class="keyword">insert</span> season_views_v2,season_id<span class="operator">=</span><span class="number">666</span> views<span class="operator">=</span><span class="number">56789</span></span><br></pre></td></tr></table></figure>

<p>目的很简单，只是为了记录下<code>season_id=xxx</code>的数据在某一时刻对应的<code>views值</code>，俩表的区别在于，<code>season_view</code>仅仅以<code>日期</code>为tag（作为索引字段，可以忽略不计），<code>season_views_v2</code>则以<code>season_id</code>作为tag，某一时刻，两张表的数据量均达到了<code>5kw</code>且<code>数据一致</code>，下面，让我们以最简单的方式，查询下这两张表：</p>
<blockquote>
<p>ℹ️ ps：<code>sql</code>前加<code>explain</code>关键字可以查看其<code>执行计划</code>，加<code>explain analyze</code>可以看到具体每一步执行的耗时。</p>
</blockquote>
<p><img src="http://myblog.sharemer.com/2019/06/21/20190621-1-10.png" alt="图10"></p>
<p>同样的查询，<code>season_id</code>加了索引和不加索引的区别：</p>
<p><code>NUMBER OF SERIES</code>（扫描系列数，加了索引后根据series的哈希算法，同一个season_id都被分在了同一个Shard里，这里之所以为8，是因为ShardGroup不同）由不加索引的64个，减少到了8个</p>
<p><code>NUMBER OF FILES</code>（扫描文件数）由不加索引的54个减少到11个</p>
<p><code>NUMBER OF BLOCKS</code>（扫描的数据块）由不加索引的152058减少到了184</p>
<h3 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h3><ol>
<li>在使用时，尽可能按照某<code>具体时间段</code>进行过滤，如果过滤条件筛选出的数据量过大，则会严重影响查询效率。</li>
<li>适度使用函数，若使用，请保证筛选条件筛选出的数据量，如果过大，效率会极低，比如在<code>season_views_v2</code>中启用<code>TOP函数</code>，查出前三名，查询耗时<code>超过10s</code>，加上<code>season_id</code>条件后，则迅速返回。</li>
<li>加索引时需要注意，尽量避免<code>大数据量的属性做tag</code>，否则会产生<code>大量series</code>，生成<code>大量索引数据</code>，占用过多内存，比如<code>用户级别</code>的tag（这里的<code>用户级别</code>是指大型网站用户数量级，一般1亿以上的情况）。</li>
<li><code>免费版</code>的InfluxDB<code>不支持集群</code>，主从需要借助<code>influx-proxy</code>实现，也可以自己通过<code>监听wal文件</code>写入，通过<code>消息队列</code>的方式实现主从同步，<code>wal</code>类似mysql里的<code>binlog</code>。</li>
<li>建议使用的时候，先把自己的库建好，然后再把RP建好，如果嫌麻烦，可以直接把自己新建的RP定义成默认RP，如果RP设置为默认，只会对查询产生影响（当然写的时候也需要指定），在sql中不指定RP的情况下执行，则认为就是走的默认RP。</li>
<li>分库，建议按照日期分。</li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="https://myblog.sharemer.com/wx_qrcode.png" alt="胖虎 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="https://myblog.sharemer.com/alipay_qrcode.png" alt="胖虎 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/InfluxDB/" rel="tag"><i class="fa fa-tag"></i> InfluxDB</a>
              <a href="/tags/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"><i class="fa fa-tag"></i> 时序数据库</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/05/21/JVM%E5%9F%BA%E7%A1%80%E5%9B%9E%E9%A1%BE%E8%AE%B0%E5%BD%95%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9A%E5%B8%B8%E8%A7%81%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/" rel="prev" title="JVM基础回顾记录（三）：常见垃圾收集器">
                  <i class="fa fa-angle-left"></i> JVM基础回顾记录（三）：常见垃圾收集器
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/07/16/%E5%88%A9%E7%94%A8Spring%E7%9A%84BeanPostProcessor%E6%9D%A5%E4%BF%AE%E6%94%B9bean%E5%B1%9E%E6%80%A7/" rel="next" title="利用Spring的BeanPostProcessor来修改bean属性">
                  利用Spring的BeanPostProcessor来修改bean属性 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">胖虎</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">187k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">11:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/exceting" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"exceting","repo":"exceting.github.io","client_id":"bf1128ab98604ef89632","client_secret":"ccd78d69fca17fc20f0d794356d1100417b78d0a","admin_user":"exceting","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"c9098c3a4f66606edd315c49e833e648"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
